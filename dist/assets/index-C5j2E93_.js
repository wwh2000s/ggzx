import{k as p,d as A,r as y,l as B,a as F,o as T,c as U,j as e,w as a,n as m,f as i,m as w,F as j,q as c,A as z,x as D,B as O,C as $,s as I,v as N,y as R,G}from"./index-BjaseuBL.js";const H=()=>p.get("/admin/acl/permission"),J=r=>r.id?p.put("/admin/acl/permission/update",r):p.post("/admin/acl/permission/save",r),K=r=>p.delete("/admin/acl/permission/remove/"+r),S=A({__name:"index",setup(r){let _=y([]),n=y(!1),t=B({code:"",level:0,name:"",pid:0});const f=async()=>{let o=await H();o.code==200&&(_.value=o.data)},C=o=>{Object.assign(t,{code:"",level:0,name:"",pid:0}),n.value=!0,t.level=o.row.level+1,t.pid=o.row.id},V=o=>{n.value=!0,Object.assign(t,o.row)},E=async()=>{(await J(t)).code==200?(c({type:"success",message:t.id?"修改成功":"添加成功"}),n.value=!1,f()):c({type:"error",message:t.id?"修改失败":"添加失败"})},k=async o=>{(await K(o.row.id)).code==200?(c({type:"success",message:"删除成功"}),f()):c({type:"error",message:"删除失败"})};return F(()=>{f()}),(o,s)=>{const u=z,d=D,x=O,P=$,v=I,b=N,q=R,M=G;return T(),U(j,null,[e(P,{border:"",data:i(_),style:{width:"100%","margin-bottom":"20px"},"row-key":"id"},{default:a(()=>[e(u,{label:"名称",align:"center",prop:"name"}),e(u,{label:"权限",align:"center",prop:"code"}),e(u,{label:"修改时间",align:"center",prop:"updateTime"}),e(u,{label:"操作",align:"center",width:"280",prop:""},{default:a((l,L)=>[e(d,{size:"small",icon:"Plus",type:"primary",onClick:g=>C(l),disabled:l.row.level==4},{default:a(()=>[m("添加菜单")]),_:2},1032,["onClick","disabled"]),e(d,{size:"small",icon:"Edit",type:"primary",onClick:g=>V(l),disabled:l.row.level==1},{default:a(()=>[m("修改")]),_:2},1032,["onClick","disabled"]),e(x,{title:"是否确认删除?",onConfirm:g=>k(l)},{reference:a(()=>[e(d,{size:"small",icon:"Delete",type:"primary",disabled:l.row.level==1},{default:a(()=>[m("删除")]),_:2},1032,["disabled"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),e(M,{modelValue:i(n),"onUpdate:modelValue":s[3]||(s[3]=l=>w(n)?n.value=l:n=l),title:i(t).id?"更新菜单":"添加菜单",width:"400"},{footer:a(()=>[e(d,{onClick:s[2]||(s[2]=l=>w(n)?n.value=!1:n=!1)},{default:a(()=>[m("取消")]),_:1}),e(d,{type:"primary",onClick:E},{default:a(()=>[m("确定")]),_:1})]),default:a(()=>[e(q,null,{default:a(()=>[e(b,{label:"名称"},{default:a(()=>[e(v,{modelValue:i(t).name,"onUpdate:modelValue":s[0]||(s[0]=l=>i(t).name=l),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),e(b,{label:"权限"},{default:a(()=>[e(v,{modelValue:i(t).code,"onUpdate:modelValue":s[1]||(s[1]=l=>i(t).code=l),placeholder:"请输入权限名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])],64)}}});export{S as default};
